<!DOCTYPE html>
<html>
	<head>
		<meta charset="ISO-8859-1">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		
		<link rel="stylesheet" href="/xsrfsynctokenptrn/resrcs/css&js/customized02.css">
		<link rel="stylesheet" href="/xsrfsynctokenptrn/resrcs/css&js/bootstrap/css/bootstrap.css">
		
		<title>Legitimate Form</title>
	</head>
	
	<body>
		<h2 align="center">Fill and Submit the below Money Transference Form!</h2>
		<!-- 
			FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM FORM
	 	-->
   		<form style="align:center" name="moneyTransferenceForm" action="/xsrfsynctokenptrn/TransferenceController" method="post">
			<div class="container">
				<label for="username"><b>Receiver Account</b></label>
				<input type="text" placeholder="Receiver's Account Number" name="accountNo" required>

				<label for="password"><b>Transfer Amount</b></label>
				<input type="text" placeholder="Amount to Transerf (in LKR)" name="transferAmount" required>

				<button type="submit" style="border-radius: 25px">Transfer</button>
			</div>
		</form>

		<script type="text/javascript">
			function callAjax(url, callback){
			    var xmlhttp;
			    // compatible with IE7+, Firefox, Chrome, Opera, Safari
			    xmlhttp = new XMLHttpRequest();
			    xmlhttp.responseType = 'json';
			    xmlhttp.onreadystatechange = function(){
			        if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
			            callback(xmlhttp.response);
			        }
			    }
			    xmlhttp.open("GET", url, true);
			    xmlhttp.send();
			}
			
			function myCallback(resp){
				console.log(resp["CSRF_key"]);
				
				var form = document.forms['moneyTransferenceForm'];
				   // form.action = 'put your url here';
				   var el = document.createElement("input");
				   el.type = "hidden";
				   el.name = "hiddenTokenField";
				   el.value = resp["CSRF_key"];
				   form.appendChild(el);
			}

			callAjax("../SyncTokenProvider", myCallback);
		</script>
	</body>
</html>